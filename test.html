<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anime Song Collection | By Hiba Laassiri</title>
  <meta name="description" content="Discover the best openings and endings from your favorite anime series">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #ff7f8e;
      --primary-dark: #ff6678;
      --secondary: #6a5af9;
      --dark: #333;
      --light: #fef8f9;
      --gray: #777;
      --card-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
      --hover-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #fef8f9 0%, #f0f2ff 100%);
      color: var(--dark);
      line-height: 1.6;
      min-height: 100vh;
    }

    header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      padding: 30px 0;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
      background-size: cover;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      position: relative;
      z-index: 1;
      text-align: center;
    }

    header h1 {
      margin: 0;
      font-size: 2.8rem;
      font-weight: 700;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    header p {
      font-size: 1.2rem;
      margin-top: 10px;
      opacity: 0.9;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .controls {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      align-items: center;
    }

    .search-box {
      position: relative;
      flex: 1;
      max-width: 500px;
    }

    .search-box input {
      width: 100%;
      padding: 14px 20px 14px 50px;
      border: none;
      border-radius: 50px;
      background: white;
      box-shadow: var(--card-shadow);
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .search-box input:focus {
      outline: none;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .search-box i {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
    }

    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .filter-btn {
      padding: 10px 20px;
      background: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: var(--card-shadow);
    }

    .filter-btn:hover {
      background: var(--primary);
      color: white;
    }

    .filter-btn.active {
      background: var(--primary);
      color: white;
    }

    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 30px;
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .card {
      background: white;
      border-radius: 15px;
      box-shadow: var(--card-shadow);
      padding: 20px;
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-10px);
      box-shadow: var(--hover-shadow);
    }

    .card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
    }

    .card-img {
      width: 100%;
      border-radius: 10px;
      height: 200px;
      object-fit: cover;
      margin-bottom: 15px;
      transition: transform 0.5s ease;
      background-color: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 0.9rem;
    }

    .card:hover .card-img {
      transform: scale(1.05);
    }

    .card h2 {
      color: var(--dark);
      margin: 10px 0 5px;
      font-size: 1.3rem;
      font-weight: 600;
    }

    .card p {
      color: var(--gray);
      font-size: 0.9rem;
      margin-bottom: 15px;
    }

    .card .song-type {
      display: inline-block;
      padding: 5px 12px;
      background: rgba(255, 127, 142, 0.1);
      color: var(--primary);
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      margin-bottom: 10px;
    }

    .card .song-type.opening {
      background: rgba(106, 90, 249, 0.1);
      color: var(--secondary);
    }

    .card-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
    }

    .play-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      background: linear-gradient(to right, var(--primary), var(--primary-dark));
      color: white;
      padding: 10px 20px;
      border-radius: 50px;
      transition: all 0.3s ease;
      font-weight: 500;
      box-shadow: 0 4px 10px rgba(255, 127, 142, 0.3);
      border: none;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.9rem;
    }

    .play-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(255, 127, 142, 0.4);
    }

    .play-btn.playing {
      background: linear-gradient(to right, var(--secondary), #5a4fd8);
    }

    .like-btn {
      background: none;
      border: none;
      font-size: 1.2rem;
      color: #ddd;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 5px;
    }

    .like-btn:hover {
      color: var(--primary);
    }

    .like-btn.liked {
      color: var(--primary);
    }

    /* Audio Player Styles */
    .audio-player {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 500px;
      background: white;
      border-radius: 50px;
      box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .audio-player.hidden {
      opacity: 0;
      transform: translateX(-50%) translateY(100px);
      pointer-events: none;
    }

    .player-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .player-btn {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .player-btn:hover {
      background: var(--primary-dark);
      transform: scale(1.1);
    }

    .player-info {
      flex: 1;
      overflow: hidden;
    }

    .player-title {
      font-weight: 600;
      font-size: 0.9rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .player-artist {
      font-size: 0.8rem;
      color: var(--gray);
      white-space: nowrap;
      overflow: hidden;
        text-overflow: ellipsis;
    }

    .progress-container {
      flex: 2;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .progress-bar {
      flex: 1;
      height: 5px;
      background: #eee;
      border-radius: 5px;
      overflow: hidden;
      cursor: pointer;
    }

    .progress {
      height: 100%;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      width: 0%;
      transition: width 0.1s linear;
    }

    .time {
      font-size: 0.8rem;
      color: var(--gray);
      min-width: 40px;
    }

    footer {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      padding: 30px 0;
      margin-top: 60px;
      text-align: center;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    .social-links a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      color: white;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .social-links a:hover {
      background: white;
      color: var(--primary);
      transform: translateY(-3px);
    }

    .stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .stat-item {
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      display: block;
    }

    .stat-label {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    @media (max-width: 768px) {
      .gallery {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        padding: 15px;
      }

      header h1 {
        font-size: 2.2rem;
      }

      .controls {
        flex-direction: column;
      }

      .search-box {
        width: 100%;
      }

      .audio-player {
        width: 95%;
        padding: 10px 15px;
      }

      .progress-container {
        flex: 1;
      }
    }

    @media (max-width: 480px) {
      .gallery {
        grid-template-columns: 1fr;
      }

      header h1 {
        font-size: 1.8rem;
      }

      .card {
        padding: 15px;
      }

      .audio-player {
        flex-direction: column;
        gap: 10px;
        border-radius: 20px;
        padding: 15px;
      }

      .player-info {
        text-align: center;
      }

      .progress-container {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <header>
    <div class="header-content">
      <h1>Anime Song Collection</h1>
      <p>Discover the best openings and endings from your favorite anime series!</p>
    </div>
  </header>

  <main>
    <div class="controls">
      <div class="search-box">
        <i class="fas fa-search" aria-hidden="true"></i>
        <input type="text" id="search" placeholder="Search for anime or song...">
      </div>
      <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="opening">Openings</button>
        <button class="filter-btn" data-filter="ending">Endings</button>
        <button class="filter-btn" data-filter="favorite">Favorites</button>
      </div>
    </div>

    <section class="gallery" id="gallery" aria-live="polite">
      <!-- Cards will be dynamically generated by JavaScript -->
    </section>
  </main>

  <!-- Audio Player -->
  <div class="audio-player hidden" id="audio-player">
    <div class="player-controls">
      <button class="player-btn" id="play-pause-btn">
        <i class="fas fa-play" id="play-pause-icon"></i>
      </button>
    </div>
    <div class="player-info">
      <div class="player-title" id="player-title">No song selected</div>
      <div class="player-artist" id="player-artist">Select a song to play</div>
    </div>
    <div class="progress-container">
      <span class="time" id="current-time">0:00</span>
      <div class="progress-bar" id="progress-bar">
        <div class="progress" id="progress"></div>
      </div>
      <span class="time" id="duration">0:00</span>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="stats">
        <div class="stat-item">
          <span class="stat-number" id="total-songs">0</span>
          <span class="stat-label">Songs</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="total-anime">0</span>
          <span class="stat-label">Anime Series</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="favorite-count">0</span>
          <span class="stat-label">Favorites</span>
        </div>
      </div>
      
      <div class="social-links">
        <a href="#" aria-label="Spotify"><i class="fab fa-spotify"></i></a>
        <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
        <a href="#" aria-label="SoundCloud"><i class="fab fa-soundcloud"></i></a>
        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
      </div>
      
      <p>Created by Hiba Laassiri | 2025</p>
    </div>
  </footer>

  <script>
    // Anime songs data with local image paths
    const animeSongs = [
      {
        id: 1,
        title: "Kamisama Hajimemashita",
        song: "Kamisama Onegai",
        artist: "Hanae",
        type: "ending",
        image: "images/anime-covers/kamisama.jpg",
        audio: "music/endings/kamisama.mp3",
        favorite: false
      },
      {
        id: 2,
        title: "Spy x Family",
        song: "Mixed Nuts",
        artist: "Official HIGE DANDism",
        type: "opening",
        image: "images/anime-covers/spyxfamily.jpg",
        audio: "music/openings/spyx.mp3",
        favorite: false
      },
      {
        id: 3,
        title: "Naruto",
        song: "Blue Bird",
        artist: "Ikimono-gakari",
        type: "opening",
        image: "images/anime-covers/naruto.jpg",
        audio: "music/openings/naruto.mp3",
        favorite: false
      },
      {
        id: 4,
        title: "Attack on Titan",
        song: "Guren no Yumiya",
        artist: "Linked Horizon",
        type: "opening",
        image: "images/anime-covers/attackontitan.jpg",
        audio: "music/openings/attack.mp3",
        favorite: false
      },
      {
        id: 5,
        title: "Your Lie in April",
        song: "Hikaru Nara",
        artist: "Goose house",
        type: "opening",
        image: "images/anime-covers/yourlieinapril.jpg",
        audio: "music/openings/yourlieinapril.mp3",
        favorite: false
      },
      {
        id: 6,
        title: "Demon Slayer",
        song: "Gurenge",
        artist: "LiSA",
        type: "opening",
        image: "images/anime-covers/demonslayer.jpg",
        audio: "music/openings/demonslayer.mp3",
        favorite: false
      },
      {
        id: 7,
        title: "My Hero Academia",
        song: "Peace Sign",
        artist: "Kenshi Yonezu",
        type: "opening",
        image: "images/anime-covers/myheroacademia.jpg",
        audio: "music/openings/myheroacademia.mp3",
        favorite: false
      },
      {
        id: 8,
        title: "One Piece",
        song: "We Are!",
        artist: "Hiroshi Kitadani",
        type: "opening",
        image: "images/anime-covers/onepiece.jpeg",
        audio: "music/openings/onepiece.mp3",
        favorite: false
      },
      {
        id: 9,
        title: "Death Note",
        song: "The World",
        artist: "Nightmare",
        type: "opening",
        image: "images/anime-covers/deathnote.jpg",
        audio: "music/openings/deathnote.mp3",
        favorite: false
      },
      {
        id: 10,
        title: "Fullmetal Alchemist",
        song: "Again",
        artist: "YUI",
        type: "opening",
        image: "images/anime-covers/fullmetalalchemist.jpg",
        audio: "music/openings/fullmetal.mp3",
        favorite: false
      },
      {
        id: 11,
        title: "Sailor Moon",
        song: "Moonlight Densetsu",
        artist: "DALI",
        type: "opening",
        image: "images/anime-covers/sailormoon.jpeg",
        audio: "music/openings/sailormoon.mp3",
        favorite: false
      },
      {
        id: 12,
        title: "Tokyo Ghoul",
        song: "Unravel",
        artist: "TK from Ling Tosite Sigure",
        type: "opening",
        image: "images/anime-covers/tokyoghoul.jpg",
        audio: "music/openings/tokyoghoul.mp3",
        favorite: false
      },
      {
        id: 13,
        title: "Fruits Basket",
        song: "Again",
        artist: "Beverly",
        type: "opening",
        image: "images/anime-covers/fruitbasket.jpg",
        audio: "music/openings/fruitbasket.mp3",
        favorite: false
      },
      {
        id: 14,
        title: "Jujutsu Kaisen",
        song: "Kaikai Kitan",
        artist: "Eve",
        type: "opening",
        image: "images/anime-covers/jujutsukaisen.jpeg",
        audio: "music/openings/jujutsuop.mp3",
        favorite: false
      },
      {
        id: 15,
        title: "Haikyuu!!",
        song: "Imagination",
        artist: "SPYAIR",
        type: "opening",
        image: "images/anime-covers/haikyu.png",
        audio: "music/openings/haikyuu.mp3",
        favorite: false
      },
      {
        id: 16,
        title: "Cowboy Bebop",
        song: "Tank!",
        artist: "The Seatbelts",
        type: "opening",
        image: "images/anime-covers/cowboybepop.jpg",
        audio: "music/openings/cowboybebop.mp3",
        favorite: false
      },
      {
        id: 17,
        title: "Neon Genesis Evangelion",
        song: "A Cruel Angel's Thesis",
        artist: "Yoko Takahashi",
        type: "opening",
        image: "images/anime-covers/evangelion.jpg",
        audio: "music/openings/evanglion.mp3",
        favorite: false
      },
      {
        id: 18,
        title: "Hunter x Hunter",
        song: "Departure!",
        artist: "Masatoshi Ono",
        type: "opening",
        image: "images/anime-covers/hunterxhunter.png",
        audio: "music/openings/hunterxhunter.mp3",
        favorite: false
      },
      {
        id: 19,
        title: "Dragon Ball Z",
        song: "Cha-La Head-Cha-La",
        artist: "Hironobu Kageyama",
        type: "opening",
        image: "images/anime-covers/dragonballz.jpeg",
        audio: "music/openings/dragonballz.mp3",
        favorite: false
      },
      {
        id: 20,
        title: "One Punch Man",
        song: "The Hero!!",
        artist: "JAM Project",
        type: "opening",
        image: "images/anime-covers/onepunchman.jpg",
        audio: "music/openings/onepunchman.mp3",
        favorite: false
      }
    ];

    // DOM elements
    const gallery = document.getElementById('gallery');
    const searchInput = document.getElementById('search');
    const filterButtons = document.querySelectorAll('.filter-btn');
    const totalSongsElement = document.getElementById('total-songs');
    const totalAnimeElement = document.getElementById('total-anime');
    const favoriteCountElement = document.getElementById('favorite-count');

    // Audio player elements
    const audioPlayer = document.getElementById('audio-player');
    const playPauseBtn = document.getElementById('play-pause-btn');
    const playPauseIcon = document.getElementById('play-pause-icon');
    const playerTitle = document.getElementById('player-title');
    const playerArtist = document.getElementById('player-artist');
    const progressBar = document.getElementById('progress-bar');
    const progress = document.getElementById('progress');
    const currentTimeEl = document.getElementById('current-time');
    const durationEl = document.getElementById('duration');

    // Audio context
    const audio = new Audio();
    let currentSong = null;
    let isPlaying = false;

    // Initialize the page
    function init() {
      displaySongs(animeSongs);
      updateStats();
      
      // Add event listeners
      searchInput.addEventListener('input', filterSongs);
      
      filterButtons.forEach(button => {
        button.addEventListener('click', () => {
          // Remove active class from all buttons
          filterButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          button.classList.add('active');
          filterSongs();
        });
      });

      // Audio player event listeners
      playPauseBtn.addEventListener('click', togglePlayPause);
      progressBar.addEventListener('click', setProgress);
      audio.addEventListener('timeupdate', updateProgress);
      audio.addEventListener('loadedmetadata', () => {
        durationEl.textContent = formatTime(audio.duration);
      });
      audio.addEventListener('ended', () => {
        isPlaying = false;
        playPauseIcon.classList.remove('fa-pause');
        playPauseIcon.classList.add('fa-play');
      });
    }

    // Display songs in the gallery
    function displaySongs(songs) {
      gallery.innerHTML = '';
      
      if (songs.length === 0) {
        gallery.innerHTML = '<p style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--gray);">No songs found matching your criteria.</p>';
        return;
      }
      
      songs.forEach(song => {
        const card = document.createElement('article');
        card.className = 'card';
        card.dataset.type = song.type;
        card.dataset.favorite = song.favorite;
        
        // Create image with error handling
        const imgHTML = `
          <img src="${song.image}" alt="${song.title} cover" class="card-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <div class="card-img" style="display:none; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); color: white; font-weight: 500;">
            ${song.title}
          </div>
        `;
        
        card.innerHTML = `
          ${imgHTML}
          <span class="song-type ${song.type}">${song.type.toUpperCase()}</span>
          <h2>${song.title}</h2>
          <p>${song.type === 'opening' ? 'Opening' : 'Ending'} Song: "${song.song}"${song.artist ? ` by ${song.artist}` : ''}</p>
          <div class="card-actions">
            <button class="play-btn" data-id="${song.id}" aria-label="Play ${song.song}">
              <i class="fas fa-play" aria-hidden="true"></i> Listen
            </button>
            <button class="like-btn ${song.favorite ? 'liked' : ''}" data-id="${song.id}" aria-label="${song.favorite ? 'Remove from' : 'Add to'} favorites">
              <i class="fas fa-heart" aria-hidden="true"></i>
            </button>
          </div>
        `;
        
        gallery.appendChild(card);
      });
      
      // Add event listeners to like buttons
      document.querySelectorAll('.like-btn').forEach(button => {
        button.addEventListener('click', toggleFavorite);
      });
      
      // Add event listeners to play buttons
      document.querySelectorAll('.play-btn').forEach(button => {
        button.addEventListener('click', playSong);
      });
    }

    // Play song function
    function playSong(event) {
      const button = event.currentTarget;
      const id = parseInt(button.dataset.id);
      const song = animeSongs.find(s => s.id === id);
      
      if (song) {
        // Update audio player UI
        playerTitle.textContent = `${song.song} - ${song.title}`;
        playerArtist.textContent = song.artist;
        audioPlayer.classList.remove('hidden');
        
        // If it's a different song, load it
        if (currentSong !== song.id) {
          audio.src = song.audio;
          currentSong = song.id;
          isPlaying = false;
        }
        
        // Toggle play/pause
        togglePlayPause();
        
        // Update play button on card to show it's playing
        document.querySelectorAll('.play-btn').forEach(btn => {
          btn.classList.remove('playing');
          btn.innerHTML = '<i class="fas fa-play" aria-hidden="true"></i> Listen';
        });
        
        if (isPlaying) {
          button.classList.add('playing');
          button.innerHTML = '<i class="fas fa-pause" aria-hidden="true"></i> Playing';
        }
      }
    }

    // Toggle play/pause
    function togglePlayPause() {
      if (audio.paused) {
        audio.play();
        isPlaying = true;
        playPauseIcon.classList.remove('fa-play');
        playPauseIcon.classList.add('fa-pause');
      } else {
        audio.pause();
        isPlaying = false;
        playPauseIcon.classList.remove('fa-pause');
        playPauseIcon.classList.add('fa-play');
      }
    }

    // Update progress bar
    function updateProgress() {
      const { duration, currentTime } = audio;
      const progressPercent = (currentTime / duration) * 100;
      progress.style.width = `${progressPercent}%`;
      currentTimeEl.textContent = formatTime(currentTime);
    }

    // Set progress bar on click
    function setProgress(e) {
      const width = this.clientWidth;
      const clickX = e.offsetX;
      const duration = audio.duration;
      
      audio.currentTime = (clickX / width) * duration;
    }

    // Format time in mm:ss
    function formatTime(seconds) {
      if (isNaN(seconds)) return '0:00';
      
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // Filter songs based on search and filter criteria
    function filterSongs() {
      const searchTerm = searchInput.value.toLowerCase();
      const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
      
      const filteredSongs = animeSongs.filter(song => {
        const matchesSearch = song.title.toLowerCase().includes(searchTerm) || 
                             song.song.toLowerCase().includes(searchTerm) ||
                             (song.artist && song.artist.toLowerCase().includes(searchTerm));
        
        const matchesFilter = activeFilter === 'all' || 
                            (activeFilter === 'favorite' && song.favorite) ||
                            (activeFilter === song.type);
        
        return matchesSearch && matchesFilter;
      });
      
      displaySongs(filteredSongs);
    }

    // Toggle favorite status
    function toggleFavorite(event) {
      const button = event.currentTarget;
      const id = parseInt(button.dataset.id);
      const song = animeSongs.find(s => s.id === id);
      
      if (song) {
        song.favorite = !song.favorite;
        button.classList.toggle('liked');
        button.setAttribute('aria-label', `${song.favorite ? 'Remove from' : 'Add to'} favorites`);
        updateStats();
        
        // If we're on the favorites filter, update the display
        const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
        if (activeFilter === 'favorite') {
          filterSongs();
        }
      }
    }

    // Update statistics
    function updateStats() {
      const totalSongs = animeSongs.length;
      const totalAnime = new Set(animeSongs.map(song => song.title)).size;
      const favoriteCount = animeSongs.filter(song => song.favorite).length;
      
      totalSongsElement.textContent = totalSongs;
      totalAnimeElement.textContent = totalAnime;
      favoriteCountElement.textContent = favoriteCount;
    }

    // Initialize the application
    init();
  </script>
</body>
</html>